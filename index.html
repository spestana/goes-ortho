<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Installation" href="installation.html" />

    <!-- Generated with Sphinx 5.3.0 and Furo 2023.03.27 -->
        <title>goes_ortho 0.2.1.5 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=fad236701ea90a88636c2a8c73b44ae642ed2a53" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="#"><div class="brand">goes_ortho 0.2.1.5 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="#">
  
  
  <span class="sidebar-brand-text">goes_ortho 0.2.1.5 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/quick_start.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/download.html">Download GOES</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/example_workflow.html">Example workflow</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="get_data.html">goes_ortho.get_data</a></li>
<li class="toctree-l1"><a class="reference internal" href="orthorectify.html">goes_ortho.orthorectify</a></li>
<li class="toctree-l1"><a class="reference internal" href="timeseries.html">goes_ortho.timeseries</a></li>
<li class="toctree-l1"><a class="reference internal" href="geometry.html">goes_ortho.geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="clip.html">goes_ortho.clip</a></li>
<li class="toctree-l1"><a class="reference internal" href="rad.html">goes_ortho.rad</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <div class="section" id="goes-abi-terrain-correction">
<h1>GOES ABI Terrain Correction<a class="headerlink" href="#goes-abi-terrain-correction" title="Permalink to this heading">#</a></h1>
<a class="reference external image-reference" href="https://zenodo.org/badge/latestdoi/281728618"><img alt="DOI" src="https://zenodo.org/badge/281728618.svg" /></a>
<a class="reference external image-reference" href="https://github.com/spestana/goes-ortho/actions/workflows/tests.yml"><img alt="tests" src="https://github.com/spestana/goes-ortho/actions/workflows/tests.yml/badge.svg" /></a>
<a class="reference external image-reference" href="https://github.com/spestana/goes-ortho/actions/workflows/build-docs.yml"><img alt="docs" src="https://github.com/spestana/goes-ortho/actions/workflows/build-docs.yml/badge.svg" /></a>
<a class="reference external image-reference" href="https://anaconda.org/conda-forge/goes-ortho"><img alt="conda-forge" src="https://img.shields.io/conda/vn/conda-forge/goes-ortho.svg" /></a>
<a class="reference external image-reference" href="https://pypi.python.org/pypi/goes-ortho"><img alt="pypi" src="https://img.shields.io/pypi/v/goes-ortho.svg" /></a>
<p>Orthorectifying GOES ABI imagery at sub-pixel resolution</p>
<a class="reference internal image-reference" href="https://raw.githubusercontent.com/spestana/goes-ortho/main/docs/images/GOES-terrain-correction.gif"><img alt="https://raw.githubusercontent.com/spestana/goes-ortho/main/docs/images/GOES-terrain-correction.gif" src="https://raw.githubusercontent.com/spestana/goes-ortho/main/docs/images/GOES-terrain-correction.gif" style="width: 600px;" /></a>
<hr class="docutils" />
<p>The latest generation of geostationary-orbiting weather satellites make frequent observations (5-60 min) in the visible and IR wavelengths at moderate resolutions (500-~2000m) (GOES-16/17 ABI, Himawari 8/9 AHI). This lends themselves to be used to fill temporal gaps between ~12-hour repeat observations by polar-orbiting spacecraft (Aqua/Terra MODIS, SNPP VIIRS, etc).
However, their geostationary orbits mean that outside of their sub-satellite-point on the equator, all other view angles are off-nadir, and due to the Earth’s curvature in view, actual pixel sizes increase to &gt;6 km towards the planet’s limb.</p>
<p>Additionally, when viewing complex terrain such as the mountains of western CONUS, parallax affects the apparent position of the variable topography. Some portions of the ground surface may even become obscured from view completely by surrounding steep terrain with poleward-facing aspects (north-facing aspects in the Northern Hemisphere, south-facing aspects in the Southern Hemisphere).</p>
<p>Before using observations from these instruments for observing the land surface over mountains, orthorectification is needed to try and account for the off-nadir view angles and topographic effects in the geostationary satellite imagery.</p>
<p>The terrain parallax is especially visually apparent when flipping between GOES-East and GOES-West views of a mountain range like the Sierra Nevada here:</p>
<a class="reference internal image-reference" href="https://raw.githubusercontent.com/spestana/goes-ortho/main/docs/images/GOES_east-west_vis.gif"><img alt="https://raw.githubusercontent.com/spestana/goes-ortho/main/docs/images/GOES_east-west_vis.gif" src="https://raw.githubusercontent.com/spestana/goes-ortho/main/docs/images/GOES_east-west_vis.gif" style="width: 600px;" /></a>
<p>The sub-pixel orthorectification method applied here uses the GOES satellite’s known orbital position (from ABI product NetCDF metadata) to compute the intersection of line of sight (LOS) vectors with a DEM surface. This method is <strong>“sub-pixel”</strong> because the DEM spatial resolution can be much finer (here I’ve used ~30 m, 1 arc-second SRTM DEM) than the GOES ABI image resolution (&gt; 2 km). This effectively drapes ABI pixels (and their respective radiance or brightness temperature values) over the terrain at the DEM’s finer resolution.</p>
<p>The figure below (from the GOES ABI ATBD) illustrates the satellite’s viewing geometry. The orthorectification method developed here modifies point P on the Earth’s surface using information from a DEM about its elevation relative to the reference ellipsoid.</p>
<a class="reference internal image-reference" href="https://raw.githubusercontent.com/spestana/goes-ortho/main/docs/images/ABIgrid.png"><img alt="https://raw.githubusercontent.com/spestana/goes-ortho/main/docs/images/ABIgrid.png" src="https://raw.githubusercontent.com/spestana/goes-ortho/main/docs/images/ABIgrid.png" style="width: 600px;" /></a>
<p>These python scripts and jupyter notebooks help with downloading GOES ABI data from AWS (wrapper around the <a class="reference external" href="https://github.com/palexandremello/goes-py">goespy</a> library), creating timeseries of GOES ABI brightness temperature for point locations, and orthorectifying (terrain correction) GOES ABI imagery using a DEM (here specifically for part of the Sierra Nevada in California).</p>
<hr class="docutils" />
<div class="section" id="setting-up-the-environment">
<h2>Setting up the environment<a class="headerlink" href="#setting-up-the-environment" title="Permalink to this heading">#</a></h2>
<p>Using <a class="reference external" href="https://docs.conda.io/projects/conda/en/latest/index.html">conda</a> or <a class="reference external" href="https://mamba.readthedocs.io/en/latest/">mamba</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>env<span class="w"> </span>create<span class="w"> </span>-f<span class="w"> </span>environment.yml
conda<span class="w"> </span>activate<span class="w"> </span>goesenv
pip<span class="w"> </span>install<span class="w"> </span>-e<span class="w"> </span>.
ipython<span class="w"> </span>kernel<span class="w"> </span>install<span class="w"> </span>--user<span class="w"> </span>--name<span class="w"> </span>goesenv
</pre></div>
</div>
<p>Also currently requires <a class="reference external" href="https://github.com/spestana/goes-py">this version of goespy</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>git+https://github.com/spestana/goes-py#egg<span class="o">=</span>goespy
</pre></div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="download-goes-py">
<h2>download-goes.py<a class="headerlink" href="#download-goes-py" title="Permalink to this heading">#</a></h2>
<p>Downloads GOES-16 or GOES-17 products/bands, requires command line arguments (wrapper around <code class="docutils literal notranslate"><span class="pre">goespy.Downloader.ABI_Downloader()</span></code>):</p>
<div class="section" id="usage">
<h3>Usage:<a class="headerlink" href="#usage" title="Permalink to this heading">#</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>./download-goes.py<span class="w"> </span>--bucket<span class="w"> </span>&lt;S3-BUCKET&gt;<span class="w"> </span>--year<span class="w"> </span>&lt;YEAR&gt;<span class="w"> </span>--month<span class="w"> </span>&lt;MONTH&gt;<span class="w"> </span>--days<span class="w"> </span>&lt;START<span class="w"> </span>DAY&gt;<span class="w"> </span>&lt;END<span class="w"> </span>DAY&gt;<span class="w"> </span>--product<span class="w"> </span>&lt;ABI<span class="w"> </span>PRODUCT<span class="w"> </span>CODE&gt;<span class="w"> </span>--channel<span class="w"> </span>&lt;ABI<span class="w"> </span>CHANNEL&gt;<span class="w"> </span>--bounds<span class="w"> </span>&lt;MIN_LAT&gt;<span class="w"> </span>&lt;MAX_LAT&gt;<span class="w"> </span>&lt;MIN_LON&gt;<span class="w"> </span>&lt;MAX_LON&gt;<span class="w"> </span>--dir<span class="w"> </span>&lt;DESTINATION<span class="w"> </span>DIRECTORY&gt;
</pre></div>
</div>
</div>
<div class="section" id="examples">
<h3>Examples:<a class="headerlink" href="#examples" title="Permalink to this heading">#</a></h3>
<p>This will download the GOES-16 ABI Level-1b Radiance (CONUS) product for channel/band 14, for January 1-2 2020. The NetCDF files will be cropped to within latitudes 30 - 50 and longitudes -125 - -105, and saved in /storage/spestana/scratchspace.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>./download-goes.py<span class="w"> </span>--bucket<span class="w"> </span>noaa-goes16<span class="w"> </span>--year<span class="w"> </span><span class="m">2020</span><span class="w"> </span>--month<span class="w"> </span><span class="m">2</span><span class="w"> </span>--days<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span>--product<span class="w"> </span>ABI-L1b-RadC<span class="w"> </span>--channel<span class="w"> </span>C14<span class="w"> </span>--bounds<span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">50</span><span class="w"> </span>-125<span class="w"> </span>-105<span class="w"> </span>--dir<span class="w"> </span>/storage/spestana/scratchspace
</pre></div>
</div>
<p>We can do the same command with short flag names:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>./download-goes.py<span class="w"> </span>-B<span class="w"> </span>noaa-goes16<span class="w"> </span>-Y<span class="w"> </span><span class="m">2020</span><span class="w"> </span>-M<span class="w"> </span><span class="m">1</span><span class="w"> </span>-D<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span>-p<span class="w"> </span>ABI-L1b-RadC<span class="w"> </span>-c<span class="w"> </span>C14<span class="w"> </span>-b<span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">50</span><span class="w"> </span>-125<span class="w"> </span>-105<span class="w"> </span>-d<span class="w"> </span>/storage/spestana/scratchspace
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="goes-ortho-make-abi-timeseries">
<h2>goes_ortho.make_abi_timeseries()<a class="headerlink" href="#goes-ortho-make-abi-timeseries" title="Permalink to this heading">#</a></h2>
<p>Creates a time series of a given GOES ABI product variable for a specified point location. This function can take into account the point’s elevation (in meters) to correct for terrain parallax from off-nadir view angles of GOES.</p>
<a class="reference internal image-reference" href="https://raw.githubusercontent.com/spestana/goes-ortho/main/docs/examples/make_abi_timeseries_example_plot.png"><img alt="https://raw.githubusercontent.com/spestana/goes-ortho/main/docs/examples/make_abi_timeseries_example_plot.png" src="https://raw.githubusercontent.com/spestana/goes-ortho/main/docs/examples/make_abi_timeseries_example_plot.png" style="width: 600px;" /></a>
<div class="section" id="id1">
<h3>Usage:<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">make_abi_timeseries</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">product</span><span class="p">,</span> <span class="n">data_vars</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">elev</span><span class="p">,</span> <span class="n">outfilepath</span><span class="p">)</span>
</pre></div>
</div>
<dl class="simple">
<dt><strong>Inputs:</strong></dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">directory</span></code>: Directory containing GOES ABI product NetCDF files (using glob, this function searches recursively and allows the use of <a class="reference external" href="https://docs.python.org/3/library/glob.html">Unix shell-style wildcards</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">product</span></code>: GOES ABI product to search directory for (using glob, this allows the use of <a class="reference external" href="https://docs.python.org/3/library/glob.html">Unix shell-style wildcards</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">data_vars</span></code>: String or list of strings, each the name of a data variable contained within the ABI product NetCDF file; If an ABI-L1b-Rad product is being read, and radiance (“Rad”) is one of the data variables in this list, an additional column will be returned (<cite>ref_or_tb</cite>) containing reflectance (for ABI bands 1-6) or brightness temperature (for ABI bands 7-16) converted from the radiance values.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lon</span></code>: Longitude in degrees (-180 to 180)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lat</span></code>: Latitude in degrees (-90 to 90)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">elev</span></code>: Elevation in meters (above GRS80 ellipsoid) of the point of interest</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">outfilepath</span></code>: Optional filepath and filename to output a csv file of the resulting pandas dataframe</p></li>
</ul>
</dd>
<dt><strong>Returns:</strong></dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">df</span></code>: Pandas dataframe where df.index is a pandas Timestamp of the GOES ABI observation time in UTC, and a column for each of the data_vars</p></li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="id3">
<h3>Examples:<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h3>
<p>See <a class="reference external" href="docs/examples/make_abi_timeseries_example.ipynb">make_abi_timeseries_example.ipynb</a> jupyter notebook.</p>
</div>
<hr class="docutils" />
<div class="section" id="goes-ortho-orthorectify-abi-and-goes-ortho-make-ortho-map">
<h3>goes_ortho.orthorectify_abi() and goes_ortho.make_ortho_map()<a class="headerlink" href="#goes-ortho-orthorectify-abi-and-goes-ortho-make-ortho-map" title="Permalink to this heading">#</a></h3>
<p>Functions for orthorectifying GOES-R ABI imagery using a DEM. Produces an orthorectified NetCDF at the spatial resolution of the input DEM.</p>
<p>This method uses the GOES satellite’s known orbital position (from ABI product NetCDF metadata) to compute the intersection of line of sight (LOS) vectors with a DEM surface.</p>
</div>
<div class="section" id="id4">
<h3>Usage:<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># import to use these functions</span>
<span class="kn">import</span> <span class="nn">goes_ortho</span>

<span class="c1"># specify filepaths for inputs</span>
<span class="n">abi_filepath</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;.\OR_ABI-L1b-RadC-M4C14_G16_s20171111750224_e20171111755027_c20171111755074.nc&quot;</span>
<span class="p">)</span>
<span class="n">dem_filepath</span> <span class="o">=</span> <span class="s2">&quot;.\dem.tif&quot;</span>

<span class="c1"># download DEM (make sure to convert to GRS80 ellipsoid model GOES ABI fixed grid uses)</span>
<span class="n">get_dem</span><span class="p">(</span>
    <span class="n">demtype</span><span class="o">=</span><span class="s2">&quot;SRTMGL3&quot;</span><span class="p">,</span>
    <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">121</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="o">-</span><span class="mi">118</span><span class="p">,</span> <span class="mi">41</span><span class="p">),</span>
    <span class="n">out_fn</span><span class="o">=</span><span class="n">dem_filepath</span><span class="p">,</span>
    <span class="n">proj</span><span class="o">=</span><span class="s2">&quot;+proj=lonlat +datum=GRS80&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># specify which data variables we want to include in the final product</span>
<span class="n">data_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Rad&quot;</span><span class="p">]</span>

<span class="c1"># generate the pixel mapping</span>
<span class="n">pixel_map</span> <span class="o">=</span> <span class="n">goes_ortho</span><span class="o">.</span><span class="n">make_ortho_map</span><span class="p">(</span><span class="n">abi_filepath</span><span class="p">,</span> <span class="n">dem_filepath</span><span class="p">)</span>

<span class="c1"># orthorectify the image</span>
<span class="n">goes_ortho</span><span class="o">.</span><span class="n">orthorectify_abi</span><span class="p">(</span>
    <span class="n">abi_filepath</span><span class="p">,</span> <span class="n">pixel_map</span><span class="p">,</span> <span class="n">data_vars</span><span class="p">,</span> <span class="n">out_filename</span><span class="o">=</span><span class="s2">&quot;test_ortho.nc&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id5">
<h3>Examples:<a class="headerlink" href="#id5" title="Permalink to this heading">#</a></h3>
<p><strong>Note:</strong> I’ve also included a copy of <a class="reference external" href="https://github.com/uw-cryo/asp-binder-demo/blob/6f03afadc7f4c6e13422da6d5f480c7f6762b47b/asp_binder_utils.py">asp_binder_utils.py</a> here which has the extremely useful <code class="docutils literal notranslate"><span class="pre">get_dem()</span></code> function for downloading geotiffs of DEMs.</p>
<p>See the <a class="reference external" href="https://github.com/spestana/goes-ortho/blob/main/examples/orthorectify_abi_example.ipynb">orthorectify_abi_example.ipynb</a> notebook for an example of orthorectifying GOES-16 and -17 images to make a pair of RGB images.</p>
<p>See the <a class="reference external" href="https://github.com/spestana/goes-ortho/blob/main/goes-orthorectify.ipynb">goes-orthorectify</a> notebook for an example of orthorectifying a single GOES ABI image.</p>
<p>See the <a class="reference external" href="https://github.com/spestana/goes-ortho/blob/main/goes-orthorectify-aster.py">goes-orthorectify-aster.py</a> script for an example of orthorectifying a batch of GOES ABI images.</p>
</div>
<div class="section" id="flowchart">
<h3>Flowchart:<a class="headerlink" href="#flowchart" title="Permalink to this heading">#</a></h3>
<p>(flowchart diagram is a work in progress)</p>
<a class="reference internal image-reference" href="https://raw.githubusercontent.com/spestana/goes-ortho/main/docs/images/goes-ortho-flowchart.png"><img alt="https://raw.githubusercontent.com/spestana/goes-ortho/main/docs/images/goes-ortho-flowchart.png" src="https://raw.githubusercontent.com/spestana/goes-ortho/main/docs/images/goes-ortho-flowchart.png" style="width: 600px;" /></a>
</div>
<hr class="docutils" />
<div class="section" id="goes-timeseries-py">
<h3>goes-timeseries.py<a class="headerlink" href="#goes-timeseries-py" title="Permalink to this heading">#</a></h3>
<p><strong>NOTE: Use ``goes_ortho.make_abi_timeseries()`` rather than this script.</strong></p>
<p>Creates a time series of GOES ABI radiance values for a specified point location. This takes into account the point’s elevation (in meters) to correct for terrain parallax from off-nadir view angles of GOES.</p>
</div>
<div class="section" id="id6">
<h3>Usage:<a class="headerlink" href="#id6" title="Permalink to this heading">#</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>./goes-timeseries.py<span class="w"> </span>-d<span class="w"> </span>/storage/GOES/goes16/2017/03<span class="w"> </span>-l<span class="w"> </span>&lt;LATITUDE&gt;<span class="w"> </span>&lt;LONGITUDE&gt;<span class="w"> </span>&lt;ELEVATION&gt;
</pre></div>
</div>
</div>
<div class="section" id="id7">
<h3>Examples:<a class="headerlink" href="#id7" title="Permalink to this heading">#</a></h3>
<p>Gaylor Pit &#64; lat=37.88175, lon=-119.31212, elev=2811:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>./goes-timeseries.py<span class="w"> </span>-d<span class="w"> </span>/storage/GOES/goes16/2017/03<span class="w"> </span>-l<span class="w"> </span><span class="m">37</span>.88175<span class="w"> </span>-119.31212<span class="w"> </span><span class="m">2811</span>
</pre></div>
</div>
<p>Grand Mesa West &#64; lat=39.0339, lon=-108.2140, elev=3033:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>./goes-timeseries.py<span class="w"> </span>-d<span class="w"> </span>/storage/GOES/goes16/2017/03<span class="w"> </span>-l<span class="w"> </span><span class="m">39</span>.0339<span class="w"> </span>-108.2140<span class="w"> </span><span class="m">3033</span>
</pre></div>
</div>
<p>CUES site &#64;  lat=37.643103, lon=-119.029146, elev=2940:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>./goes-timeseries.py<span class="w"> </span>-d<span class="w"> </span>/storage/GOES/goes16/2017/03<span class="w"> </span>-l<span class="w"> </span><span class="m">37</span>.643103<span class="w"> </span>-119.029146<span class="w"> </span><span class="m">2940</span>
</pre></div>
</div>
<div class="toctree-wrapper compound">
<p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/quick_start.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/download.html">Download GOES</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/example_workflow.html">Example workflow</a></li>
</ul>
</div>
<div class="toctree-wrapper compound">
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="get_data.html">goes_ortho.get_data</a></li>
<li class="toctree-l1"><a class="reference internal" href="orthorectify.html">goes_ortho.orthorectify</a><ul>
<li class="toctree-l2"><a class="reference internal" href="orthorectify.html#orthorectify.ABIpixelMap"><code class="docutils literal notranslate"><span class="pre">ABIpixelMap()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="orthorectify.html#orthorectify.make_ortho_map"><code class="docutils literal notranslate"><span class="pre">make_ortho_map()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="orthorectify.html#orthorectify.make_ortho_map_zarr"><code class="docutils literal notranslate"><span class="pre">make_ortho_map_zarr()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="orthorectify.html#orthorectify.ortho"><code class="docutils literal notranslate"><span class="pre">ortho()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="orthorectify.html#orthorectify.ortho_zarr"><code class="docutils literal notranslate"><span class="pre">ortho_zarr()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="orthorectify.html#orthorectify.orthorectify_abi"><code class="docutils literal notranslate"><span class="pre">orthorectify_abi()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="orthorectify.html#orthorectify.orthorectify_abi_zarr"><code class="docutils literal notranslate"><span class="pre">orthorectify_abi_zarr()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="timeseries.html">goes_ortho.timeseries</a><ul>
<li class="toctree-l2"><a class="reference internal" href="timeseries.html#timeseries.make_abi_timeseries"><code class="docutils literal notranslate"><span class="pre">make_abi_timeseries()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="timeseries.html#timeseries.make_nested_abi_timeseries"><code class="docutils literal notranslate"><span class="pre">make_nested_abi_timeseries()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="geometry.html">goes_ortho.geometry</a><ul>
<li class="toctree-l2"><a class="reference internal" href="geometry.html#geometry.ABIangle2LonLat"><code class="docutils literal notranslate"><span class="pre">ABIangle2LonLat()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="geometry.html#geometry.LonLat2ABIangle"><code class="docutils literal notranslate"><span class="pre">LonLat2ABIangle()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="geometry.html#geometry.calcLookAngles"><code class="docutils literal notranslate"><span class="pre">calcLookAngles()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="geometry.html#geometry.get_nested_coords"><code class="docutils literal notranslate"><span class="pre">get_nested_coords()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="geometry.html#geometry.goes_azi"><code class="docutils literal notranslate"><span class="pre">goes_azi()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="geometry.html#geometry.goes_lza"><code class="docutils literal notranslate"><span class="pre">goes_lza()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="clip.html">goes_ortho.clip</a><ul>
<li class="toctree-l2"><a class="reference internal" href="clip.html#clip.subsetNetCDF"><code class="docutils literal notranslate"><span class="pre">subsetNetCDF()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="rad.html">goes_ortho.rad</a><ul>
<li class="toctree-l2"><a class="reference internal" href="rad.html#rad.abi_radiance_wavenumber_to_wavelength"><code class="docutils literal notranslate"><span class="pre">abi_radiance_wavenumber_to_wavelength()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="rad.html#rad.goesBrightnessTemp"><code class="docutils literal notranslate"><span class="pre">goesBrightnessTemp()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="rad.html#rad.goesReflectance"><code class="docutils literal notranslate"><span class="pre">goesReflectance()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="rad.html#rad.makeABIrgb_fromReflectance"><code class="docutils literal notranslate"><span class="pre">makeABIrgb_fromReflectance()</span></code></a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</div>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="installation.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Installation</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Steven Pestana
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">GOES ABI Terrain Correction</a><ul>
<li><a class="reference internal" href="#setting-up-the-environment">Setting up the environment</a></li>
<li><a class="reference internal" href="#download-goes-py">download-goes.py</a><ul>
<li><a class="reference internal" href="#usage">Usage:</a></li>
<li><a class="reference internal" href="#examples">Examples:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#goes-ortho-make-abi-timeseries">goes_ortho.make_abi_timeseries()</a><ul>
<li><a class="reference internal" href="#id1">Usage:</a></li>
<li><a class="reference internal" href="#id3">Examples:</a></li>
<li><a class="reference internal" href="#goes-ortho-orthorectify-abi-and-goes-ortho-make-ortho-map">goes_ortho.orthorectify_abi() and goes_ortho.make_ortho_map()</a></li>
<li><a class="reference internal" href="#id4">Usage:</a></li>
<li><a class="reference internal" href="#id5">Examples:</a></li>
<li><a class="reference internal" href="#flowchart">Flowchart:</a></li>
<li><a class="reference internal" href="#goes-timeseries-py">goes-timeseries.py</a></li>
<li><a class="reference internal" href="#id6">Usage:</a></li>
<li><a class="reference internal" href="#id7">Examples:</a><ul>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/furo.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    </body>
</html>